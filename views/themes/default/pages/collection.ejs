<!-- 页面标题区域 -->
<section class="page-header">
  <div class="container">
    <div class="page-header-content">
      <h1 class="page-title">我的收藏</h1>
      <p class="page-subtitle">收藏的精彩内容都在这里</p>
    </div>
  </div>
</section>

<div class="main-content">
  <!-- 分类标签栏 -->
  <div class="category-tabs">
    <div class="tabs-container">
      <button class="tab-item active" data-category="all">全部</button>
      <% if (categories && categories.length > 0) { %>
        <% categories.forEach(function(category) { %>
      <button class="tab-item" data-category="<%= category.slug %>">
        <%= category.name %>
      </button>
        <% }); %>
      <% } %>
    </div>
  </div>

  <!-- 视频网格 -->
  <div class="video-grid">
    <% if (videos && videos.length > 0) { %>
      <% videos.forEach(function(video) { %>
    <div
      class="video-card"
      data-category="<%= video.category ? video.category.slug : 'all' %>"
    >
      <div class="video-thumbnail">
        <a href="<%= video.url %>">
          <% if (video.thumbnail) { %>
          <img
            src="<%= video.thumbnail %>"
            alt="<%= video.title %>"
            loading="lazy"
            onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
          />
          <% } %>
          <div
            class="thumbnail-placeholder"
            style="<%= video.thumbnail ? 'display: none;' : 'display: flex;' %>"
          >
            <svg viewBox="0 0 24 24" class="play-icon">
              <path d="M8 5v14l11-7z" fill="currentColor" />
            </svg>
            <span class="placeholder-text">视频封面</span>
          </div>
          <div class="video-duration"><%= video.duration || '0:00' %></div>
        </a>
      </div>
      <div class="video-info">
        <div class="channel-avatar">
          <a href="/users/<%= video.author ? video.author.id : '#' %>">
            <% if (video.author && video.author.avatar) { %>
            <img
              src="<%= video.author.avatar %>"
              alt="<%= video.author.displayName %>"
              onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
            />
            <% } %>
            <div
              class="avatar-fallback"
              style="
                <%=(video.author && video.author.avatar)? 'display: none;' : 'display: flex;'
                  %>;
              "
            >
              <%= video.author ?
              video.author.displayName.charAt(0).toUpperCase() : 'U' %>
            </div>
          </a>
        </div>
        <div class="video-details">
          <h3 class="video-title">
            <a href="<%= video.url %>"><%= video.title %></a>
          </h3>
          <div class="video-meta">
            <div class="channel-name">
              <a href="/users/<%= video.author ? video.author.id : '#' %>">
                <%= video.author ? video.author.displayName : '未知用户' %>
                <% if (video.author && video.author.verified) { %>
                <span class="verified-badge">✓</span>
                <% } %>
              </a>
            </div>
            <div class="video-stats">
              <%= video.formattedViewCount || '0' %>次观看 • <%=
              video.formattedPublishDate || '刚刚' %>
            </div>
          </div>
        </div>
        <div class="video-menu">
          <button class="menu-btn" data-video-id="<%= video.id %>">
            <svg viewBox="0 0 24 24">
              <path
                d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"
              />
            </svg>
          </button>
        </div>
      </div>
    </div>
      <% }); %>
    <% } else { %>
    <div class="no-videos">
      <div class="no-content-message">
        <svg viewBox="0 0 24 24" class="no-content-icon">
          <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" fill="none" stroke="currentColor" stroke-width="2"/>
        </svg>
        <h3>还没有收藏内容</h3>
        <p>快去发现喜欢的视频并收藏吧！</p>
        <a href="/" class="btn btn-primary">去首页看看</a>
      </div>
    </div>
    <% } %>
  </div>

  <!-- 使用分页组件 -->
  <%- include('../components/pagination', { 
    pagination: pagination, 
    baseUrl: '/collection',
    queryParams: {} 
  }) %>
</div>
